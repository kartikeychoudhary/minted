# MISTAKES.md â€” Learning From Errors

> **Rule:** Read this entire file at the start of every new task.
> **Rule:** Add entries after every error, retry, or unexpected behavior.
> **Rule:** If a mistake repeats, move its prevention rule to the HIGH PRIORITY section.

---

## ðŸ”´ HIGH PRIORITY (Repeated Mistakes)

<!-- When a mistake from below occurs more than once, move its prevention rule here in bold -->

1. **NEVER generate Angular standalone components. Always use `--standalone=false` flag. Always verify generated component has `standalone: false` or no standalone property in `@Component` decorator.**
2. **NEVER add libraries outside the approved tech stack (PrimeNG, AG Grid, Tailwind, FortAwesome). No Material, No Bootstrap, No NgRx.**
3. **NEVER use `spring.jpa.hibernate.ddl-auto=create` or `update`. Always use `validate`. All schema changes go through Flyway migrations.**
4. **NEVER expose JPA Entity objects directly in REST responses. Always use DTOs.**
5. **NEVER hardcode secrets, passwords, or connection strings. Always use environment variables.**
6. **NEVER store API keys (LLM, third-party) as plain text in the database. Always use `@Convert(converter = ApiKeyEncryptor.class)` on sensitive entity fields.**
7. **NEVER use `anyRequest().permitAll()` in SecurityConfig. Always use `anyRequest().denyAll()` (default-deny). New endpoints must be explicitly whitelisted.**
8. **NEVER leak `ex.getMessage()` in generic 500 error responses. Log full stack trace server-side with `log.error(...)` and return only a safe generic message to the client.**
9. **NEVER modify a Flyway migration after it has been applied to ANY database. ALWAYS create a NEW migration to fix issues. Modifying applied migrations causes checksum mismatches that crash the app on startup.**
10. **ALWAYS verify PrimeNG icon names exist before using them. Use PrimeNG Icons documentation. Do NOT guess icon names â€” `pi-shop` does not exist, use `pi-shopping-cart` or `pi-shopping-bag`.**

---

## Build Errors

| Date | Error | Root Cause | Fix | Prevention |
|------|-------|------------|-----|------------|
| 2026-02-16 | Tailwind CSS v4 PostCSS plugin error | Installed Tailwind v4 which requires `@tailwindcss/postcss` plugin | Downgraded to Tailwind CSS v3 and used standard `tailwindcss` PostCSS plugin | Always use Tailwind CSS v3.x for Angular projects until v4 is fully compatible. Check package.json to verify version. |

---

## Runtime Errors

| Date | Error | Root Cause | Fix | Prevention |
|------|-------|------------|-----|------------|
| _template_ | _describe error_ | _why it happened_ | _what fixed it_ | _how to prevent_ |

---

## Angular Errors

| Date | Error | Root Cause | Fix | Prevention |
|------|-------|------------|-----|------------|
| 2026-02-16 | "Could not resolve @angular/animations/browser" build error | @angular/animations package not installed. PrimeNG requires Angular animations but it wasn't in package.json | Installed @angular/animations: `npm install @angular/animations` | Always install @angular/animations when using PrimeNG. It's a required peer dependency. Check package.json after Angular project creation. |
| 2026-02-16 | "Cannot find module 'primeng/sidebar'" | Attempted to import non-existent PrimeNG module. Not all PrimeNG v17+ modules follow the same pattern | Removed SidebarModule import from SharedModule | Always check PrimeNG documentation for correct module imports. PrimeNG v17+ reorganized some modules. Verify imports before using. |
| 2026-02-16 | "NG01052: formGroup expects a FormGroup instance" runtime error | FormGroup declared with `!` operator but initialized in ngOnInit(). Template rendered before initialization completed | Changed to optional `loginForm?: FormGroup`, added `*ngIf="loginForm"` to template, added null checks | When using reactive forms, either initialize in constructor OR make the FormGroup optional and use `*ngIf` in template. Never use `!` operator with forms initialized in lifecycle hooks. |
| 2026-02-17 | "NG0201: No provider for MessageService" in TransactionsModule | PrimeNG services (MessageService, ConfirmationService) injected in component but not provided at module level | Added `providers: [MessageService, ConfirmationService]` to TransactionsModule's `@NgModule` decorator | **ALWAYS provide PrimeNG services (MessageService, ConfirmationService) in the module's providers array when components inject them. These are NOT provided in root by default.** Every feature module that uses PrimeNG toasts or confirm dialogs needs these providers. |
| 2026-02-17 | "NG8001: 'p-accordionTab' is not a known element" build error | Used old PrimeNG v17 accordion syntax (`<p-accordionTab>`) instead of PrimeNG v18 syntax | Changed to use `<p-accordion-panel>`, `<p-accordion-header>`, and `<p-accordion-content>` components | **PrimeNG v18 changed accordion syntax. Use `<p-accordion-panel>` NOT `<p-accordionTab>`. Header and content now use separate components: `<p-accordion-header>` and `<p-accordion-content>`. Use `[value]` property on accordion to set initial open panels (array of strings for multiple mode). Always check PrimeNG v18 documentation for component syntax changes.** |
| 2026-02-18 | Custom date pickers not appearing on first click in transactions page | Change detection not triggered when `showCustomDatePickers` was set to true. Angular didn't re-render the template immediately to show the `*ngIf="showCustomDatePickers"` section | Added `this.cdr.detectChanges()` call after setting `showCustomDatePickers = true` in `onDateFilterChange()` method | **When dynamically showing/hiding UI elements with property changes, explicitly call `ChangeDetectorRef.detectChanges()` if the change doesn't trigger automatically. This is especially important for conditional rendering with `*ngIf` that needs immediate visual feedback. Always inject ChangeDetectorRef and use it when toggling UI visibility.** |
| 2026-02-18 | AG Grid not visible when no transactions exist | AG Grid was rendering but showing blank screen when rowData was empty. Missing overlay template configuration for empty state | Added `overlayNoRowsTemplate` to gridOptions: `overlayNoRowsTemplate: '<span class="ag-overlay-no-rows-center">No transactions found. Add a transaction to get started.</span>'` | **Always configure `overlayNoRowsTemplate` in AG Grid gridOptions to provide user feedback when no data exists. AG Grid shows a default message but custom templates provide better UX. The grid will still render headers and structure even with empty rowData array.** |
| 2026-02-18 | "AG Grid: error #272 No AG Grid modules are registered!" runtime error | AG Grid v35+ requires explicit module registration. Breaking change from v34 where modules were auto-registered. Without registration, grid fails to initialize and throws "Cannot read properties of undefined (reading 'dispatchEvent')" errors | Added module registration in main.ts BEFORE bootstrapping: `import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community'; ModuleRegistry.registerModules([AllCommunityModule]);`. Also increased initial bundle budget from 2MB to 3MB as AG Grid modules (~1MB) are now in initial bundle | **CRITICAL: AG Grid v35+ requires ModuleRegistry.registerModules([AllCommunityModule]) to be called before grid initialization. Always register in main.ts before bootstrapModule() for global availability. This adds ~1MB to initial bundle size - adjust angular.json budgets accordingly (initial: 3MB/4MB recommended). Check AG Grid migration guide when upgrading major versions.** |
| 2026-02-19 | Angular lazy loaded module routing returns blank page or routes don't exist | `admin-module.ts` imported an empty generated file `admin-routing-module.ts` instead of the manually configured `admin-routing.module.ts` | Corrected the import statement to point to `admin-routing.module.ts` | **ALWAYS verify the exact filename when importing routing modules in Angular. IDE auto-imports might link to empty/scaffolded files instead of your configured route module, causing silent routing failures.** |
| 2026-02-25 | TS2345: `string \| number \| undefined` not assignable to `string \| number` in PrimeNG Tabs `(valueChange)` handler | PrimeNG Tabs `value` is a `ModelSignal<string \| number>` whose `valueChange` emits `string \| number \| undefined`. Typed the handler param too narrowly | Added `\| undefined` to parameter type and early-return guard | **PrimeNG ModelSignal events can emit `undefined`. Always type event handler params as `T \| undefined` when binding to `(valueChange)` on PrimeNG signal-based components.** |
| 2026-02-25 | Material Icons used in split dialog template (`<span class="material-icons">balance</span>`) â€” icons don't render | Stitch UI prototypes use Material Icons but the project only loads PrimeIcons and FortAwesome | Replaced all `material-icons` spans with PrimeIcons: `pi-equals`, `pi-chart-pie`, `pi-percentage`, `pi-times`, `pi-sitemap` | **NEVER use Material Icons (`<span class="material-icons">`) in templates. Project only permits PrimeIcons (`pi pi-*`) and FortAwesome. Stitch prototypes use Material Icons â€” always convert to PrimeIcons when implementing.** |
| 2026-02-25 | NG5002: `Opening tag "p-dialog" not terminated` build error | Added `(onHide)` attribute to `<p-dialog>` but forgot the closing `>` on the tag | Added missing `>` after the `(onHide)` attribute | **When adding attributes to multi-line HTML tags, always verify the tag has a closing `>`. Easy to miss on tags spanning many lines.** |
| 2026-02-26 | NG8002: `Can't bind to 'options' since it isn't a known property of 'p-multiselect'` build error | Used `<p-multiselect>` in DashboardConfigComponent template but `MultiSelectModule` was not imported in `SharedModule`. PrimeNG components require their module to be imported before use. | Added `import { MultiSelectModule } from 'primeng/multiselect'` to `SharedModule` and included it in the `PRIMENG_MODULES` array. | **When using a new PrimeNG component for the first time, ALWAYS check if its module is already in SharedModule. If not, add it. Common missing modules: MultiSelectModule, ColorPickerModule, FileUploadModule. Check SharedModule's PRIMENG_MODULES array before building.** |
| 2026-02-20 | Data not appearing on screen / screen stuck spinning "loading" after API call success | Angular's default `OnPush` change detection strategy does not automatically update views after asynchronous callbacks (like HTTP subscriptions) finish processing | Injected `ChangeDetectorRef` into the component and called `this.cdr.detectChanges();` securely inside the `.subscribe({ next: () => {...}, error: () => {...} })` blocks | **CRITICAL: When using `OnPush` change detection, you MUST explicitly call `ChangeDetectorRef.detectChanges()` inside any asynchronous callback (Promises, `setTimeout`, `RxJS` Observables) that modifies UI-bound properties (like `loading = false` or `data = res`). Otherwise, the UI will appear frozen or stuck loading until the user clicks somewhere on the screen.** |
| 2026-02-20 | `NullPointerException: Cannot invoke "JobExecution.getSteps()" because "jobExecution" is null` in async import processing | **Two issues:** (1) `processImportAsync()` self-invocation bypassed `@Transactional`; (2) `CompletableFuture.runAsync()` fired BEFORE the parent `@Transactional` method committed, so `job_execution_id` was still NULL in the database when the async thread loaded the entity | (1) Wrapped `processImportAsync()` body in `TransactionTemplate.executeWithoutResult(...)` for a programmatic transaction. (2) Used `TransactionSynchronizationManager.registerSynchronization(afterCommit)` to defer the `CompletableFuture.runAsync()` until after the parent transaction commits | **CRITICAL: Two rules for async processing from @Transactional methods: (A) `@Transactional` does NOT work on self-invocations â€” use `TransactionTemplate` programmatically. (B) NEVER fire `CompletableFuture.runAsync()` inside a `@Transactional` method if the async task reads data written in that transaction â€” the transaction hasn't committed yet! Use `TransactionSynchronizationManager.registerSynchronization(new TransactionSynchronization() { afterCommit() { ... } })` to defer async work until after commit.** |

---

## Spring Boot Errors

| Date | Error | Root Cause | Fix | Prevention |
|------|-------|------------|-----|------------|
| 2026-02-16 | JWT `parserBuilder()` method not found | jjwt 0.12.x has different API than 0.11.x | Updated to use `Jwts.parser().verifyWith().build().parseSignedClaims()` instead of `parserBuilder()`, and `Jwts.SIG.HS256` instead of `SignatureAlgorithm.HS256` | Always check jjwt documentation for version-specific API. jjwt 0.12+ uses different builder patterns. |
| 2026-02-20 | `Schema-validation: wrong column type encountered in column [import_type] in table [bulk_imports]; found [varchar (Types#VARCHAR)], but expecting [enum ('csv','credit_card_statement') (Types#ENUM)]` â€” Docker container crash-loops on startup | Hibernate 6.4.1 on MySQL maps `@Enumerated(EnumType.STRING)` to native MySQL ENUM type by default. The Flyway migration creates `VARCHAR(30)` columns, causing a schema validation mismatch | Added `@JdbcTypeCode(Types.VARCHAR)` annotation (from `org.hibernate.annotations.JdbcTypeCode` + `java.sql.Types`) to both `importType` and `status` enum fields in `BulkImport.java`, matching the existing pattern in `JobExecution.java` | **CRITICAL: When using `@Enumerated(EnumType.STRING)` with Hibernate 6.x on MySQL and VARCHAR columns in Flyway migrations, you MUST also add `@JdbcTypeCode(Types.VARCHAR)` to prevent Hibernate from expecting a native MySQL ENUM type. Always check existing entities (e.g., `JobExecution.java`) for the correct pattern before adding new enum fields.** |
| 2026-02-23 | 69 compilation errors after package refactoring: `cannot find symbol` for entity cross-references (User, Account, TransactionCategory, JobExecution, etc.) | Entities that were in the same `com.minted.api.entity` package referenced each other without imports (same-package access). After moving to separate feature packages (e.g., `account.entity`, `user.entity`), these implicit references broke | Added explicit cross-module imports to all entity files (e.g., `import com.minted.api.user.entity.User;` in Account.java) | **When refactoring packages: entities/classes in the same package reference each other without imports. After splitting into different packages, ALL cross-references need explicit imports. Also: wildcard imports like `import com.minted.api.dto.*` must be replaced with specific imports from the new module packages. Always do a full build after package refactoring.** |
| 2026-02-23 | `NamedQueryValidationException: Could not interpret path expression 'com.minted.api.enums.TransactionType.EXPENSE'` â€” app fails to start after package refactoring | JPQL `@NamedQuery` annotations use fully-qualified enum class names as string literals (e.g., `com.minted.api.enums.TransactionType.EXPENSE`). These are NOT caught by Java compilation â€” they only fail at runtime when Hibernate validates the queries | Updated the JPQL string from `com.minted.api.enums.TransactionType.EXPENSE` to `com.minted.api.transaction.enums.TransactionType.EXPENSE` | **CRITICAL: When refactoring packages, JPQL/HQL queries with fully-qualified class names in string literals (inside `@NamedQuery`, `@Query` annotations) are NOT caught by the Java compiler. Always grep the entire codebase for old package paths in string literals after a package refactoring. Use `grep -r "com.minted.api.enums"` (or the old package prefix) to find these.** |
| 2026-02-24 | Security audit: LLM API keys stored as plain text in `llm_configurations.api_key` column | No encryption applied to sensitive fields â€” anyone with DB access could read all API keys | Created `ApiKeyEncryptor` (AES-256-GCM JPA `AttributeConverter`) and applied `@Convert` on `LlmConfiguration.apiKey`. Legacy plain-text values are gracefully handled (re-encrypted on next save) | **ALWAYS use `@Convert(converter = ApiKeyEncryptor.class)` on any entity field that stores API keys or secrets. Never store third-party credentials as plain text in the database.** |
| 2026-02-24 | Security audit: Jasypt configured with weak `PBEWithMD5AndDES` + `NoIvGenerator` | DES is 56-bit (trivially breakable), MD5 is collision-vulnerable, no IV means deterministic ciphertext | Upgraded to `PBEWITHHMACSHA512ANDAES_256` with `RandomIvGenerator` and 1000 iterations | **Always use AES-256 for Jasypt encryption. Never use DES or MD5-based algorithms. Always use `RandomIvGenerator` to prevent pattern leakage.** |
| 2026-02-24 | Security audit: `anyRequest().permitAll()` in SecurityConfig exposed all unmatched routes | Default-allow posture means any new endpoint is publicly accessible without authentication | Changed to `anyRequest().denyAll()` â€” default-deny ensures new endpoints must be explicitly whitelisted | **ALWAYS use `.anyRequest().denyAll()` in Spring Security config. Default-deny is a fundamental security principle.** |
| 2026-02-24 | Security audit: `GlobalExceptionHandler` returned `ex.getMessage()` in 500 responses | Exception messages can leak internal details (DB host, connection strings, class names) to API consumers | Replaced `ex.printStackTrace()` with `log.error(...)` and removed `ex.getMessage()` from response body | **Never include raw exception messages in API error responses. Log server-side, return generic message to client.** |

---

## SQL / Migration Errors

| Date | Error | Root Cause | Fix | Prevention |
|------|-------|------------|-----|------------|
| 2026-02-16 | Login failing with "Invalid username or password" despite correct credentials | The BCrypt hash `$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy` in V0_0_1 migration was incorrect and did not match the password "admin" | Created V0_0_2 migration to update admin password with correct BCrypt hash generated from Spring's BCryptPasswordEncoder | **CRITICAL:** Always generate BCrypt hashes using the SAME BCryptPasswordEncoder that will be used in production. Never use online generators or different BCrypt implementations as they may produce incompatible hashes. Test password verification immediately after creating seed users. |
| 2026-02-16 | "Flyway checksum mismatch for migration version 0.0.1" - Server fails to start | Modified V0_0_1 migration file after it was already applied to database. Flyway stores checksums of applied migrations and validates them on startup | Reverted V0_0_1 file to exact original content (removed added comments). Checksum matched and server started successfully | **NEVER modify a migration file after it has been applied to ANY database (even dev). If you need to fix data, create a NEW migration (e.g., V0_0_2). Only modify migrations that have never been applied. To fix checksum mismatches: use `flyway repair` or restore the file to its exact original state.** |
| 2026-02-17 | "Unknown column 'account_number' in 'field list'" in V0_0_11 migration | Migration SQL referenced `account_number` column that doesn't exist in accounts table schema (V0_0_5). Did not verify table schema before writing INSERT statement | Read V0_0_5__create_accounts_table.sql to check actual schema. Removed `account_number` column from INSERT and incorporated account numbers into the `name` field instead | **ALWAYS read the table creation migration before writing INSERT statements in seed data migrations. Never assume column names - verify the actual schema. Use `SHOW COLUMNS FROM table_name;` or read the CREATE TABLE migration file to confirm column names and types.** |
| 2026-02-17 | "Validate failed: Detected failed migration to version 0.0.11" - Backend fails to start after fixing migration | Flyway records failed migrations in `flyway_schema_history` with `success=0`. Even after fixing the SQL file, Flyway sees the failed entry and refuses to retry | Deleted the failed entry from flyway_schema_history table: `DELETE FROM flyway_schema_history WHERE version = '0.0.11';` Then restarted backend which successfully applied the corrected migration | **When a Flyway migration fails, you MUST delete the failed entry from flyway_schema_history before retrying. Use: `DELETE FROM flyway_schema_history WHERE version = 'X.X.X' AND success = 0;` or use `./gradlew flywayRepair` (though direct SQL is more reliable). Always verify deletion with `SELECT * FROM flyway_schema_history WHERE version = 'X.X.X';` before restarting.** |

---

## API Integration Errors

| Date | Error | Root Cause | Fix | Prevention |
|------|-------|------------|-----|------------|
| 2026-02-19 | TS2729: Property used before initialization | Initialized class fields using `this.themeService` at declaration level, before the constructor runs | Moved assignments into the constructor body; declared fields with `!` and explicit types (`Observable<boolean>`) | **NEVER reference `this.injectedService` in class field initializers. Constructor parameters are only set after `constructor()` runs. Either declare with `!` and assign in constructor, OR use `ngOnInit()` for initialization.**

---

## UI / Styling Errors

| Date | Error | Root Cause | Fix | Prevention |
|------|-------|------------|-----|------------|
| 2026-02-17 | Search input with icon misaligned with dropdown filters in transactions page | Used basic HTML `<span class="p-input-icon-left">` instead of proper PrimeNG component for icon input | Replaced with PrimeNG `<p-iconfield iconPosition="left"><p-inputicon styleClass="pi pi-search" /><input pInputText /></p-iconfield>` components | **ALWAYS use PrimeNG IconField component for inputs with icons. Never use basic span with `p-input-icon-left` class. Always check SharedModule for available PrimeNG components before implementing UI. Always prefer PrimeNG components over custom HTML/CSS implementations.** |
| 2026-02-25 | Material icons not appearing on Splits page | Used `<span class="material-symbols-outlined">` from Stitch prototype HTML files, but the app loads `Material Icons` (not Material Symbols) via Google Fonts CDN in index.html | Changed all `material-symbols-outlined` to `material-icons` in splits-page.html and cell renderers | **CRITICAL: The app uses `<span class="material-icons">icon_name</span>` (loaded via Google Fonts CDN in index.html). Stitch/prototype HTML files use `material-symbols-outlined` which is a DIFFERENT font family not loaded in the app. ALWAYS use `material-icons` class, never `material-symbols-outlined`.** |
| 2026-02-25 | Cards and text not following dark theme on Splits page | Used hardcoded Tailwind color classes (bg-white, text-slate-900, border-slate-200) instead of CSS variable inline styles | Replaced all hardcoded colors with inline `style="background-color: var(--minted-bg-card); color: var(--minted-text-primary);"` etc. | **CRITICAL: NEVER use hardcoded Tailwind color classes (bg-white, text-slate-900, border-slate-200) for theme-aware elements. ALWAYS use inline style attributes with CSS variables: `style="background-color: var(--minted-bg-card); border: 1px solid var(--minted-border); color: var(--minted-text-primary);"`. The app's dark mode works by swapping CSS variable values on `.dark-mode` class toggle. Hardcoded Tailwind classes bypass this system. Reference analytics-overview.html for the correct pattern.** |
| 2026-02-25 | Category icons not rendering in transactions grid â€” HTML showed `class="text-base restaurant"` | Categories settings UI `iconOptions` array stored Material icon names (`restaurant`, `shopping_bag`) as `value` (saved to DB) while only displaying PrimeNG icons visually. V0_0_32 migration only caught `fa-*` prefixed icons, not bare Material names. | Changed `iconOptions` values to `pi pi-*` format. Added `getIconClass()` fallback in cell renderer. Created V0_0_34 migration to convert bare Material names + catch-all for any non-`pi pi-*` icons. | **When dropdown/select options display one value but save another to DB, ensure the saved `value` is the actual usable class/identifier, NOT a display-only mapping. Also: data migrations must account for ALL icon formats in the DB, not just one prefix pattern. Always add a catch-all UPDATE for any remaining non-conforming values.** |
| 2026-02-25 | Used invalid PrimeNG icon `pi pi-shop` in V0_0_33 migration | Guessed icon name without verifying it exists in PrimeIcons. `pi-shop` is not a valid PrimeNG icon. | Created V0_0_34 to fix `pi pi-shop` â†’ `pi pi-shopping-cart`. | **ALWAYS verify PrimeNG icon names exist before using them in code or migrations. Use the PrimeNG Icons documentation or the MCP `get_icons_guide` tool. Common valid icons: `pi-shopping-cart`, `pi-shopping-bag`, `pi-home`, `pi-heart`, `pi-book`, `pi-car`, `pi-wallet`, `pi-tag`.** |
| 2026-02-25 | Attempted to modify already-applied Flyway migration V0_0_33 | Forgot V0_0_33 was already applied to the database. Modifying it would cause a checksum mismatch on next startup. | Reverted V0_0_33 to its original applied content and created V0_0_34 as a new migration. | **NEVER modify a migration after it has been applied. ALWAYS create a new migration file to fix issues from previous migrations. This is a repeated mistake â€” see SQL/Migration Errors section.** |
| 2026-02-28 | Dashboard charts show black bars despite colors configured in Settings â†’ Dashboard Config | Two issues: (1) PrimeNG `p-colorPicker` with default `format="hex"` outputs values WITHOUT `#` prefix (e.g., `c48821`). Chart.js can't parse these as colors â†’ renders black. (2) Chart builders used `c.color` (category color from DB) as primary source with palette as fallback â€” since most categories had a color set, the dashboard config palette was never used. | (1) Normalized `#` prefix in `DashboardConfigService.getChartColors()` and `saveChartColors()`. (2) Changed chart builders to always use `this.getColor(i)` from dashboard config palette, ignoring category-level colors. | **PrimeNG ColorPicker `format="hex"` outputs values WITHOUT `#`. Always normalize hex colors with `#` prefix when reading from or saving to storage. When building charts, be explicit about color source priority â€” if a user-configured palette exists, use it instead of entity-level colors.** |
| 2026-02-28 | Dashboard account filter dropdown has no effect on charts/KPIs | Frontend `loadDashboardData()` called analytics APIs without passing `selectedAccountId`. Backend analytics endpoints didn't accept `accountId` at all. | Added `accountId` param to backend controller/service/repository. Frontend passes `this.selectedAccountId` to all 3 API calls. | **When adding a filter UI control, trace the full data flow: UI â†’ component method â†’ service call â†’ API endpoint â†’ backend service â†’ repository query. All layers must accept and forward the filter parameter.** |
| 2026-02-28 | PrimeNG `p-drawer` overlay mask stays in DOM after programmatic close + route navigation | Setting `visible = false` and immediately navigating via `router.navigate()` interrupts PrimeNG's leave animation, leaving `<div class="p-drawer-mask p-overlay-mask p-overlay-mask-leave-active">` blocking all clicks | Delay navigation by 350ms to let drawer animation start, then navigate, then manually remove `.p-drawer-mask` elements from DOM after 50ms | **When programmatically closing a PrimeNG Drawer and immediately navigating, the overlay mask can get stuck. Use a delayed approach: (1) set visible=false, (2) setTimeout 350ms, (3) navigate, (4) setTimeout 50ms to remove `.p-drawer-mask` elements from DOM.** |

---

## Implementation Notes

| Date | Feature | Implementation Details | Notes |
|------|---------|----------------------|-------|
| 2026-02-17 | Analytics Overview Dashboard | Implemented full analytics dashboard with PrimeNG components including: p-card for summary cards, p-chart for spending activity, p-accordion for recurring payments, p-tag for status badges, p-progressbar for forecast visualization, p-skeleton for loading states. All data fetched from existing backend APIs: /analytics/total-balance, /analytics/summary, /analytics/spending-activity, /transactions/date-range, /recurring-transactions, /recurring-transactions/summary. No new backend APIs needed. | Successfully used all PrimeNG components from SharedModule. Added AccordionModule, BadgeModule, TagModule, ProgressBarModule to SharedModule. All APIs already exist in backend - no backend changes required. Component is fully dynamic and responsive. |
| 2026-02-17 | Analytics UI Color Scheme Update | Updated analytics overview to match consistent color scheme across all pages. Main changes: text-slate-900 for headings, text-slate-600 for labels, text-slate-500 for secondary text, bg-white with border-slate-200 for cards, #c48821 (amber) for primary actions, added p-8 padding to main container. Removed greeting header ("Good evening, System Administrator") and subtitle. Changed washed-out colors to vibrant amber-600, green-700, red-700 for better contrast and consistency. | **Color scheme standards for new pages: Primary text: text-slate-900, Labels: text-slate-600, Secondary/meta text: text-slate-500, Cards: bg-white border-slate-200, Primary color: #c48821 (amber), Container padding: p-8. Always match existing pages' color schemes before creating new UI.** |
| 2026-02-18 | Transactions Page AG Grid Migration | Replaced PrimeNG p-table with AG Grid (ag-grid-community v35.1.0). Created custom "ag-theme-minted" theme matching reference design. Implemented features: checkbox selection, external filters (date, account, category, search), AG Grid native pagination, edit functionality via cell click, custom cell renderers for category icons and edit button, hover-to-show edit button, Material Icons Outlined integration. Kept existing PrimeNG dialog for add/edit/delete. Increased Angular budget for anyComponentStyle from 16kB to 500kB to accommodate AG Grid CSS (~230kB). | **AG Grid Integration: Import AgGridModule in feature module, use custom theme for consistent styling, cell renderers for complex UI elements, external filters work with rowData updates, pagination built-in to AG Grid. AG Grid CSS is large (~230kB) - adjust budgets in angular.json. Use Material Icons Outlined for icon consistency. Cell renderers return HTML strings for performance.** |
