<div class="space-y-10">
  <!-- Personal Information Section -->
  <section>
    <div class="mb-6">
      <h2 class="text-lg font-semibold" style="color: var(--minted-text-primary);">Personal Information</h2>
      <p class="text-sm" style="color: var(--minted-text-secondary);">Update your basic profile information and how we
        contact you.</p>
    </div>

    <div class="rounded-xl border shadow-sm overflow-hidden"
      style="border-color: var(--minted-border); background-color: var(--minted-bg-card);">
      <form *ngIf="profileForm" [formGroup]="profileForm" (ngSubmit)="saveProfile()">
        <div class="p-6 space-y-6">
          <!-- Profile Photo -->
          <div class="flex items-center gap-6">
            <app-avatar-upload [currentAvatarUrl]="currentUser?.avatarBase64"
              [initials]="getInitials(currentUser?.displayName || currentUser?.username || 'U')"
              [color]="'var(--minted-accent)'" label="Profile Picture" size="lg"
              (avatarSelected)="onAvatarSelected($event)" (avatarRemoved)="onAvatarRemoved()">
            </app-avatar-upload>
            <div class="flex-1">
              <h3 class="font-medium" style="color: var(--minted-text-primary);">Profile Photo</h3>
              <p class="text-xs mt-1" style="color: var(--minted-text-secondary);">PNG, JPG or GIF. Max 2MB.</p>
            </div>
          </div>

          <!-- Form Fields -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Display Name -->
            <div>
              <label for="displayName" class="block text-sm font-medium mb-2"
                style="color: var(--minted-text-secondary);">Display Name</label>
              <input pInputText id="displayName" formControlName="displayName" placeholder="Enter your name"
                class="w-full"
                [class.p-invalid]="profileForm.get('displayName')?.invalid && profileForm.get('displayName')?.touched" />
              <small class="p-error block mt-1"
                *ngIf="profileForm.get('displayName')?.invalid && profileForm.get('displayName')?.touched">
                Display name is required
              </small>
            </div>

            <!-- Email -->
            <div>
              <label for="email" class="block text-sm font-medium mb-2"
                style="color: var(--minted-text-secondary);">Email Address</label>
              <input pInputText id="email" formControlName="email" type="email" placeholder="your.email@example.com"
                class="w-full"
                [class.p-invalid]="profileForm.get('email')?.invalid && profileForm.get('email')?.touched" />
              <small class="p-error block mt-1"
                *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched">
                Valid email is required
              </small>
            </div>

            <!-- Username (Read-only) -->
            <div>
              <label for="username" class="block text-sm font-medium mb-2"
                style="color: var(--minted-text-secondary);">Username</label>
              <input pInputText id="username" formControlName="username" class="w-full"
                style="background-color: var(--minted-bg-surface);" />
              <small class="text-xs mt-1 block" style="color: var(--minted-text-secondary);">Username cannot be
                changed</small>
            </div>
          </div>
        </div>

        <div class="px-6 py-4 border-t flex justify-end"
          style="background-color: var(--minted-bg-surface); border-color: var(--minted-border);">
          <button pButton type="submit" label="Save Changes" [disabled]="profileForm.invalid"
            style="background-color: var(--minted-accent); border-color: var(--minted-accent);">
          </button>
        </div>
      </form>
    </div>
  </section>

  <!-- Security Settings Section -->
  <section>
    <div class="mb-6">
      <h2 class="text-lg font-semibold" style="color: var(--minted-text-primary);">Security Settings</h2>
      <p class="text-sm" style="color: var(--minted-text-secondary);">Manage your password and security preferences.</p>
    </div>

    <div class="rounded-xl border shadow-sm overflow-hidden"
      style="border-color: var(--minted-border); background-color: var(--minted-bg-card);">
      <form *ngIf="passwordForm" [formGroup]="passwordForm" (ngSubmit)="updatePassword()">
        <div class="p-6 space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Current Password -->
            <div class="md:col-span-2">
              <label for="currentPassword" class="block text-sm font-medium mb-2"
                style="color: var(--minted-text-secondary);">Current Password</label>
              <p-password id="currentPassword" formControlName="currentPassword" placeholder="Enter current password"
                [toggleMask]="true" [feedback]="false" styleClass="w-full" inputStyleClass="w-full"
                [class.p-invalid]="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched">
              </p-password>
              <small class="p-error block mt-1"
                *ngIf="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched">
                Current password is required
              </small>
            </div>

            <!-- New Password -->
            <div>
              <label for="newPassword" class="block text-sm font-medium mb-2"
                style="color: var(--minted-text-secondary);">New Password</label>
              <p-password id="newPassword" formControlName="newPassword" placeholder="Min. 8 characters"
                [toggleMask]="true" styleClass="w-full" inputStyleClass="w-full"
                [class.p-invalid]="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched">
              </p-password>
              <small class="p-error block mt-1"
                *ngIf="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched">
                Password must be at least 8 characters
              </small>
            </div>

            <!-- Confirm Password -->
            <div>
              <label for="confirmPassword" class="block text-sm font-medium mb-2"
                style="color: var(--minted-text-secondary);">Confirm New Password</label>
              <p-password id="confirmPassword" formControlName="confirmPassword" placeholder="Re-type new password"
                [toggleMask]="true" [feedback]="false" styleClass="w-full" inputStyleClass="w-full"
                [class.p-invalid]="passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched">
              </p-password>
              <small class="p-error block mt-1"
                *ngIf="passwordForm.get('confirmPassword')?.errors?.['passwordMismatch'] && passwordForm.get('confirmPassword')?.touched">
                Passwords do not match
              </small>
            </div>
          </div>

          <!-- Two-Factor Authentication -->
          <div class="pt-2 border-t" style="border-color: var(--minted-border);">
            <div class="flex items-center justify-between">
              <div class="flex flex-col">
                <span class="text-sm font-medium" style="color: var(--minted-text-primary);">Two-Factor
                  Authentication</span>
                <span class="text-xs" style="color: var(--minted-text-secondary);">Secure your account with an extra
                  layer of protection.</span>
              </div>
              <p-toggleswitch [(ngModel)]="twoFactorEnabled" [ngModelOptions]="{standalone: true}"
                (onChange)="onTwoFactorChange($event)"></p-toggleswitch>
            </div>
          </div>
        </div>

        <div class="px-6 py-4 border-t flex justify-end"
          style="background-color: var(--minted-bg-surface); border-color: var(--minted-border);">
          <button pButton type="submit" label="Update Password" [disabled]="passwordForm.invalid"
            style="background-color: var(--minted-accent); border-color: var(--minted-accent);">
          </button>
        </div>
      </form>
    </div>
  </section>

  <!-- Appearance Section -->
  <section>
    <div class="mb-6">
      <h2 class="text-lg font-semibold" style="color: var(--minted-text-primary);">Appearance</h2>
      <p class="text-sm" style="color: var(--minted-text-secondary);">Customize the look and feel of Minted.</p>
    </div>

    <div class="rounded-xl border shadow-sm overflow-hidden"
      style="border-color: var(--minted-border); background-color: var(--minted-bg-card);">
      <!-- Dark / Light Mode Toggle -->
      <div class="p-6 flex items-center justify-between border-b" style="border-color: var(--minted-border);">
        <div class="flex items-start gap-4">
          <div class="p-2 rounded-lg" style="background-color: #fef9ee; color: var(--minted-accent);">
            <i [class]="(isDarkMode$ | async) ? 'pi pi-moon' : 'pi pi-sun'" style="font-size: 1.25rem;"></i>
          </div>
          <div>
            <p class="text-sm font-medium" style="color: var(--minted-text-primary);">Dark Mode</p>
            <p class="text-xs" style="color: var(--minted-text-secondary);">Switch between light and dark interface.</p>
          </div>
        </div>
        <p-toggleswitch [ngModel]="isDarkMode$ | async" [ngModelOptions]="{standalone: true}"
          (onChange)="onDarkModeChange($event)">
        </p-toggleswitch>
      </div>

      <!-- Accent Color Picker -->
      <div class="p-6 border-b" style="border-color: var(--minted-border);">
        <p class="text-sm font-medium mb-4" style="color: var(--minted-text-primary);">Accent Color</p>
        <div class="flex items-center gap-3 flex-wrap">
          <button *ngFor="let preset of accentPresets" type="button" (click)="onAccentSelect(preset.color)"
            class="w-9 h-9 rounded-full flex items-center justify-center transition-transform hover:scale-110 focus:outline-none"
            [style.background-color]="preset.color" [pTooltip]="preset.label" tooltipPosition="top"
            [attr.aria-label]="preset.label + ' accent color'">
            <i *ngIf="(accentColor$ | async) === preset.color" class="pi pi-check text-white"
              style="font-size: 1rem;"></i>
          </button>
        </div>
        <p class="text-xs mt-3" style="color: var(--minted-text-secondary);">
          Changes are applied immediately and saved automatically.
        </p>
      </div>

      <!-- Currency Picker -->
      <div class="p-6">
        <div class="flex items-start gap-4">
          <div class="p-2 rounded-lg" style="background-color: #f0fdf4; color: #16a34a;">
            <i class="pi pi-money-bill" style="font-size: 1.25rem;"></i>
          </div>
          <div class="flex-1">
            <p class="text-sm font-medium mb-1" style="color: var(--minted-text-primary);">Default Currency</p>
            <p class="text-xs mb-3" style="color: var(--minted-text-secondary);">Used everywhere in the app —
              transactions, budgets, analytics.</p>
            <p-select [(ngModel)]="selectedCurrency" [ngModelOptions]="{standalone: true}" [options]="currencies"
              optionLabel="label" optionValue="code" (onChange)="onCurrencyChange($event.value)"
              styleClass="w-full md:w-64" appendTo="body">
            </p-select>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Notification Preferences Section -->
  <section>
    <div class="mb-6">
      <h2 class="text-lg font-semibold" style="color: var(--minted-text-primary);">Notification Preferences</h2>
      <p class="text-sm" style="color: var(--minted-text-secondary);">Control how and when you receive alerts from
        Minted.</p>
    </div>

    <div class="rounded-xl border shadow-sm overflow-hidden"
      style="border-color: var(--minted-border); background-color: var(--minted-bg-card);">
      <!-- Transaction Alerts -->
      <div class="p-6 flex items-center justify-between border-b" style="border-color: var(--minted-border);">
        <div class="flex items-start gap-4">
          <div class="p-2 rounded-lg" style="background-color: var(--minted-bg-surface); color: #2563eb;">
            <i class="pi pi-receipt" style="font-size: 1.25rem;"></i>
          </div>
          <div>
            <p class="text-sm font-medium" style="color: var(--minted-text-primary);">Transaction Alerts</p>
            <p class="text-xs" style="color: var(--minted-text-secondary);">Receive notifications for large transactions
              over $500.</p>
          </div>
        </div>
        <p-toggleswitch [(ngModel)]="transactionAlertsEnabled"
          (onChange)="onTransactionAlertsChange($event)"></p-toggleswitch>
      </div>

      <!-- Budget Overrun -->
      <div class="p-6 flex items-center justify-between border-b" style="border-color: var(--minted-border);">
        <div class="flex items-start gap-4">
          <div class="p-2 rounded-lg" style="background-color: #faf5ff; color: #9333ea;">
            <i class="pi pi-exclamation-triangle" style="font-size: 1.25rem;"></i>
          </div>
          <div>
            <p class="text-sm font-medium" style="color: var(--minted-text-primary);">Budget Overrun</p>
            <p class="text-xs" style="color: var(--minted-text-secondary);">Get notified when you've reached 80% of any
              monthly budget.</p>
          </div>
        </div>
        <p-toggleswitch [(ngModel)]="budgetOverrunEnabled" (onChange)="onBudgetOverrunChange($event)"></p-toggleswitch>
      </div>

      <!-- Weekly Summary -->
      <div class="p-6 flex items-center justify-between">
        <div class="flex items-start gap-4">
          <div class="p-2 rounded-lg" style="background-color: #f0fdf4; color: #16a34a;">
            <i class="pi pi-chart-bar" style="font-size: 1.25rem;"></i>
          </div>
          <div>
            <p class="text-sm font-medium" style="color: var(--minted-text-primary);">Weekly Summary</p>
            <p class="text-xs" style="color: var(--minted-text-secondary);">A weekly email with insights on your
              spending habits.</p>
          </div>
        </div>
        <p-toggleswitch [(ngModel)]="weeklySummaryEnabled" (onChange)="onWeeklySummaryChange($event)"></p-toggleswitch>
      </div>

      <div class="px-6 py-4 border-t flex justify-end"
        style="background-color: var(--minted-bg-surface); border-color: var(--minted-border);">
        <button pButton type="button" label="Save Preferences" (click)="saveNotificationPreferences()"
          style="background-color: var(--minted-accent); border-color: var(--minted-accent);">
        </button>
      </div>
    </div>
  </section>
</div>